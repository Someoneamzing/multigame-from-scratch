{"code":"!function(t){var e={};function i(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},i.r=function(t){Object.defineProperty(t,\"__esModule\",{value:!0})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,\"a\",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p=\"\",i(i.s=234)}({2:function(t,e,i){\"use strict\";var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),o=function t(e,i,r){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,i);if(void 0===o){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,i,r)}if(\"value\"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0};function n(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}function a(t,e){if(!t)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!e||\"object\"!=typeof e&&\"function\"!=typeof e?t:e}function s(t,e){if(\"function\"!=typeof e&&null!==e)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var c=i(50),l=function(t){function e(t){n(this,e);var i=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),r=t.x,o=void 0===r?0:r,s=t.y,c=void 0===s?0:s,l=t.world,h=void 0===l?0:l,u=t.w,p=void 0===u?32:u,f=t.h,y=void 0===f?32:f;return i.x=o,i.y=c,i.world=h,i.w=p,i.h=y,e.list[i.id]=i,i}return s(e,c.client),r(e,[{key:\"render\",value:function(t){t.colour(\"purple\"),t.centerRect(this)}},{key:\"update\",value:function(t){this.x=t.x,this.y=t.y,this.world=t.world,o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"update\",this).call(this,t)}},{key:\"remove\",value:function(){delete this.constructor.list[this.id],o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"remove\",this).call(this)}},{key:\"type\",get:function(){var t=o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"type\",this);return t.push(e.trackName),t}}]),e}(),h=function(t){function e(t){n(this,e);var i=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),r=t.x,s=void 0===r?0:r,c=t.y,l=void 0===c?0:c,h=t.world,u=void 0===h?0:h,p=t.w,f=void 0===p?32:p,y=t.h,v=void 0===y?32:y,d=t.solid,m=void 0!==d&&d;return i.x=s,i.y=l,i.world=u,i.w=f,i.h=v,i.hsp=0,i.vsp=0,i.solid=m,e.list[i.id]=i,console.log(o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"type\",i)),i}return s(e,c.server),r(e,[{key:\"dist\",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.x,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.y;return Math.pow(t.x-e,2)+Math.pow(t.y-i,2)}},{key:\"collision\",value:function(t,i,r,o){for(var n in e.list){var a=e.list[n];if(a.id!=this.id&&((void 0===o||a.type.includes(o))&&(!r||a.solid)&&!(t-this.w/2>a.x+a.w/2||t+this.w/2<a.x-a.w/2||i-this.h/2>a.y+a.h/2||i+this.h/2<a.y-a.h/2)))return a}return!1}},{key:\"update\",value:function(){if(this.collision(this.x+this.hsp,this.y,!0)){for(;!this.collision(this.x+Math.sign(this.hsp),this.y,!0);)this.x+=Math.sign(this.hsp);this.hsp=0}if(this.x+=this.hsp,this.collision(this.x,this.y+this.vsp,!0)){for(;!this.collision(this.x,this.y+Math.sign(this.vsp),!0);)this.y+=Math.sign(this.vsp);this.vsp=0}this.y+=this.vsp,this.markDirty()}},{key:\"remove\",value:function(){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"remove\",this).call(this),delete e.list[this.id]}},{key:\"getInitPkt\",value:function(){var t=o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"getInitPkt\",this).call(this);return t.x=this.x,t.y=this.y,t.w=this.w,t.h=this.h,t.world=this.world,t}},{key:\"getUpdatePkt\",value:function(){var t=o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"getUpdatePkt\",this).call(this);return t.x=this.x,t.y=this.y,t.world=this.world,t}},{key:\"type\",get:function(){var t=o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"type\",this);return t.push(e.trackName),t}}]),e}();t.exports={client:l,server:h}},20:function(t,e,i){\"use strict\";var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),o=function t(e,i,r){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,i);if(void 0===o){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,i,r)}if(\"value\"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0};function n(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}function a(t,e){if(!t)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!e||\"object\"!=typeof e&&\"function\"!=typeof e?t:e}function s(t,e){if(\"function\"!=typeof e&&null!==e)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var c=i(2),l=function(t){function e(t){n(this,e);var i=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),r=t.category,o=t.variant,s=t.health,c=t.healthMax;return i.category=r,i.variant=o,console.log(r,o),i.health=s,i.healthMax=c,i.sprite=Sprites.get(\"decoration_\"+i.category+\"_\"+i.variant),e.list[i.id]=i,i}return s(e,c.client),r(e,[{key:\"render\",value:function(t){this.sprite.drawCenter(t,this)}},{key:\"remove\",value:function(){delete this.constructor.list[this.id],o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"remove\",this).call(this)}},{key:\"update\",value:function(t){this.category=t.category,this.variant=t.variant,o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"update\",this).call(this,t),this.x>canvas.camera.x-canvas.width/2&&this.x<canvas.camera.x+canvas.width/2&&this.y>canvas.camera.y-canvas.height/2&&this.y<canvas.camera.y+canvas.height/2&&e.visible.push(this)}},{key:\"type\",get:function(){var t=o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"type\",this);return t.push(e.trackName),t}}]),e}(),h=function(t){function e(t){n(this,e);var i=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),r=t.category,o=t.variant,s=t.health,c=t.healthMax;return i.category=r,i.variant=o,i.health=s,i.healthMax=c,e.list[i.id]=i,initPack[e.trackName][i.id]=i.getInitPkt(),i}return s(e,c.server),r(e,[{key:\"getInitPkt\",value:function(){var t=o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"getInitPkt\",this).call(this);return t.category=this.category,t.variant=this.variant,t}},{key:\"getUpdatePkt\",value:function(){var t=o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"getInitPkt\",this).call(this);return t.category=this.category,t.variant=this.variant,t}},{key:\"update\",value:function(){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"update\",this).call(this)}},{key:\"damage\",value:function(t,e){this.health=Math.max(this.health-t,0),this.health<=0&&this.kill(e)}},{key:\"kill\",value:function(t){t.exp+=Math.floor(3*Math.random()),this.remove()}},{key:\"type\",get:function(){var t=o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"type\",this);return t.push(e.trackName),t}}],[{key:\"getUpdate\",value:function(){var t={};for(var i in e.list){var r=e.list[i];r.dirty&&(t[i]=r.getUpdatePkt())}return t}},{key:\"getInit\",value:function(){var t={};for(var i in e.list){var r=e.list[i];t[i]=r.getInitPkt()}return t}}]),e}();l.trackName=h.trackName=\"Decoration\",h.list={},l.list={},l.visible=[],t.exports={client:l,server:h}},21:function(t,e,i){\"use strict\";var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),o=function t(e,i,r){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,i);if(void 0===o){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,i,r)}if(\"value\"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0};function n(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}function a(t,e){if(!t)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!e||\"object\"!=typeof e&&\"function\"!=typeof e?t:e}function s(t,e){if(\"function\"!=typeof e&&null!==e)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var c=i(2),l=function(t){function e(t){n(this,e);var i=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),r=t.item,o=t.count;return i.item=r,i.count=o,e.list[i.id]=i,i}return s(e,c.client),r(e,[{key:\"render\",value:function(t){Sprites.get(\"item_\"+this.item).drawCenter(t,this)}},{key:\"remove\",value:function(){delete this.constructor.list[this.id],o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"remove\",this).call(this)}},{key:\"update\",value:function(t){this.item=t.item,this.count=t.count,o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"update\",this).call(this,t)}},{key:\"type\",get:function(){var t=o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"type\",this);return t.push(e.trackName),t}}]),e}(),h=function(t){function e(t){n(this,e);var i=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),r=t.item,o=t.count,s=t.delay;return i.item=r,i.count=o,i.delay=s,e.list[i.id]=i,initPack[e.trackName][i.id]=i.getInitPkt(),i}return s(e,c.server),r(e,[{key:\"getInitPkt\",value:function(){var t=o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"getInitPkt\",this).call(this);return t.item=this.item,t.count=this.count,t}},{key:\"getUpdatePkt\",value:function(){var t=o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"getUpdatePkt\",this).call(this);return t.item=this.item,t.count=this.count,t}},{key:\"update\",value:function(){var t=this.collision(this.x,this.y,!1,\"Player\");if(this.delay<=0&&t&&!t.dead){var i=t.inventory.add(this.item,this.count,\"any\");this.count-=i,console.log(i,this.count),this.count<=0&&this.remove()}this.delay=Math.max(this.delay-1,0),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"update\",this).call(this)}},{key:\"type\",get:function(){var t=o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"type\",this);return t.push(e.trackName),t}}],[{key:\"getUpdate\",value:function(){var t={};for(var i in e.list){var r=e.list[i];r.dirty&&(t[i]=r.getUpdatePkt())}return t}},{key:\"getInit\",value:function(){var t={};for(var i in e.list){var r=e.list[i];t[i]=r.getInitPkt()}return t}}]),e}();l.trackName=h.trackName=\"Item\",h.list={},l.list={},t.exports={client:l,server:h}},229:function(t,e,i){\"use strict\";var r=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&\"function\"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?\"symbol\":typeof t},o=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}();var n=function(){function t(e,i){var r=i.x,o=i.y,n=i.zoom;!function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,t),this.ctx=e,this.x=r,this.y=o,this.zoom=n}return o(t,[{key:\"setPos\",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;\"object\"==(void 0===t?\"undefined\":r(t))?(this.x=t.x,this.y=t.y):(this.x=t,this.y=e)}}]),t}();t.exports={client:n}},230:function(t,e,i){\"use strict\";var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}();var o=i(229),n=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new o.client(e,{x:0,y:0,zoom:1});!function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,t),this.ctx=e,this.canvas=$(this.ctx.canvas),this.camera=r,this.minimap=!1!==i&&new t(i,!1,new o.client(this.hasMini,{x:0,y:0,zoom:.1})),console.log(this.minimap)}return r(t,[{key:\"resize\",value:function(t){var e=t.w,i=t.h;this.ctx.canvas.width=e,this.ctx.canvas.height=i,this.colour(\"red\"),this.rect({x:0,y:0,w:this.width,h:this.height},!0)}},{key:\"rect\",value:function(t,e){var i=t.x,r=t.y,o=t.w,n=t.h;e?this.ctx.strokeRect(i,r,o,n):this.ctx.fillRect(i,r,o,n)}},{key:\"centerRect\",value:function(t,e){var i=t.x,r=t.y,o=t.w,n=t.h;e?this.ctx.strokeRect(i-o/2,r-n/2,o,n):this.ctx.fillRect(i-o/2,r-n/2,o,n)}},{key:\"colour\",value:function(t){this.ctx.fillStyle=t,this.ctx.strokeStyle=t}},{key:\"text\",value:function(t,e,i){this.ctx.textAlign=\"center\",this.ctx.textBaseline=\"middle\",this.ctx.fillText(t,e,i)}},{key:\"textWO\",value:function(t,e,i,r,o){var n=this.ctx.fillStyle,a=this.ctx.lineWidth;this.ctx.fillStyle=r,this.ctx.lineWidth=1,this.ctx.strokeStyle=o,this.ctx.textAlign=\"center\",this.ctx.textBaseline=\"middle\",this.ctx.fillText(t,e,i),this.ctx.strokeText(t,e,i),this.colour(n),this.lineWidth(a)}},{key:\"lineWidth\",value:function(t){this.ctx.lineWidth=t}},{key:\"font\",value:function(t){this.ctx.font=t}},{key:\"clear\",value:function(){this.ctx.clearRect(0,0,this.canvas.width(),this.canvas.height())}},{key:\"update\",value:function(){this.ctx.save(),this.minimap&&(this.minimap.clear(),this.minimap.camera.setPos(this.camera.x,this.camera.y),this.minimap.update()),this.ctx.scale(this.camera.zoom,this.camera.zoom),this.ctx.translate(-(this.camera.x-this.width/(2*this.camera.zoom)),-(this.camera.y-this.height/(2*this.camera.zoom)))}},{key:\"reset\",value:function(){this.ctx.restore(),this.minimap&&this.minimap.reset()}},{key:\"background\",value:function(t){for(var e=this.camera,i=e.x,r=e.y,o=t.w,n=t.h,a=this.width,s=this.height,c=[{n:((i-=a)-i%o)/o,m:((r-=s)-r%n)/n},{n:(i+a-(i+a)%o)/o+2,m:(r-r%n)/n},{n:(i-i%o)/o,m:(r+s-(r+s)%n)/n+2}],l=c[1].n-c[0].n,h=c[2].m-c[0].m,u=0;u<=l;u++)for(var p=0;p<=h;p++)t.drawCenter(this,{x:(c[0].n+u)*o,y:(c[0].m+p)*n,w:o,h:n})}},{key:\"width\",get:function(){return this.canvas.width()}},{key:\"height\",get:function(){return this.canvas.height()}}]),t}();t.exports={client:n}},231:function(t,e,i){\"use strict\";var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}();var o=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,t),this.loaders=e}return r(t,[{key:\"load\",value:function(){var t,e=(t=regeneratorRuntime.mark(function t(e,i){var r,o,n,a,s,c;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=!0,o=!1,n=void 0,t.prev=3,a=this.loaders[Symbol.iterator]();case 5:if(r=(s=a.next()).done){t.next=12;break}return c=s.value,t.next=9,c.load(e);case 9:r=!0,t.next=5;break;case 12:t.next=18;break;case 14:t.prev=14,t.t0=t.catch(3),o=!0,n=t.t0;case 18:t.prev=18,t.prev=19,!r&&a.return&&a.return();case 21:if(t.prev=21,!o){t.next=24;break}throw n;case 24:return t.finish(21);case 25:return t.finish(18);case 26:i();case 27:case\"end\":return t.stop()}},t,this,[[3,14,18,26],[19,,21,25]])}),function(){var e=t.apply(this,arguments);return new Promise(function(t,i){return function r(o,n){try{var a=e[o](n),s=a.value}catch(t){return void i(t)}if(!a.done)return Promise.resolve(s).then(function(t){r(\"next\",t)},function(t){r(\"throw\",t)});t(s)}(\"next\")})});return function(t,i){return e.apply(this,arguments)}}()}]),t}();t.exports={client:o}},232:function(t,e,i){\"use strict\";var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}();var o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,t),this.list=[],this.total=0,this.toLoad=[]}return r(t,[{key:\"test\",value:function(t){t.css(\"width\",this.list.length/this.total*100+\"%\"),this.list.length==this.total&&(this.indicator=null)}},{key:\"add\",value:function(t){this.toLoad.push(t),this.total++}},{key:\"load\",value:function(t){t.css(\"width\",\"0\");var e=[],i=!0,r=!1,o=void 0;try{for(var n,a=this.toLoad[Symbol.iterator]();!(i=(n=a.next()).done);i=!0){var s=n.value;e.push(s.load(this,t))}}catch(t){r=!0,o=t}finally{try{!i&&a.return&&a.return()}finally{if(r)throw o}}return Promise.all(e)}},{key:\"get\",value:function(t){return this.list[this.list.findIndex(function(e){return e.name==t})]}},{key:\"update\",value:function(){var t=!0,e=!1,i=void 0;try{for(var r,o=this.list[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){r.value.update()}}catch(t){e=!0,i=t}finally{try{!t&&o.return&&o.return()}finally{if(e)throw i}}}}]),t}();t.exports={client:o}},233:function(t,e,i){\"use strict\";var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}();function o(t){function e(){var e=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}var n=function(t){function e(t){var i=t.src,r=t.name,o=void 0===r?i.match(/([\\w-]+)(?=\\.(?:png|jpg|jpeg|mpeg|gif))/)[0]:r,n=t.w,a=void 0===n?32:n,s=t.h,c=void 0===s?32:s,l=t.frames,h=void 0===l?1:l,u=t.speed,p=void 0===u?0:u;!function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,e);var f=function(t,e){if(!t)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!e||\"object\"!=typeof e&&\"function\"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return f.name=o,f.w=a,f.h=c,f.frames=h,f.index=0,f.speed=p,f.path=i,f.loaded=!1,f.offScreenC=document.createElement(\"canvas\"),f.offScreenC.width=f.w,f.offScreenC.height=f.h,f.offScreen=f.offScreenC.getContext(\"2d\"),f}return function(t,e){if(\"function\"!=typeof e&&null!==e)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o(Image)),r(e,[{key:\"load\",value:function(t,e){var i=this;return new Promise(function(r){i.onload=function(){t.list.push(i),t.test(e),i.loaded=!0,r()},i.onerror=function(){reject()},i.src=i.path})}},{key:\"update\",value:function(){this.index++,this.index=this.index>=this.frames?0:this.index,this.offScreen.drawImage(this,this.index*this.width,0,this.w,this.h,0,0,w,h)}},{key:\"draw\",value:function(t,e){var i=e.x,r=e.y,o=e.w,n=e.h,a=e.rot;t.ctx.save(),t.ctx.translate(i,r),t.ctx.rotate(a),t.ctx.drawImage(this,this.index*this.width,0,this.w,this.h,0,0,o,n),t.ctx.restore()}},{key:\"drawCenter\",value:function(t,e){var i=e.x,r=e.y,o=e.w,n=e.h,a=e.rot;t.ctx.save(),t.ctx.translate(i,r),t.ctx.rotate(a),t.ctx.drawImage(this,this.index*this.width,0,this.w,this.h,-o/2,-n/2,o,n),t.ctx.restore()}},{key:\"image\",get:function(){return this.offScreen.toDataURL()}}]),e}();t.exports={client:n}},234:function(t,e,i){\"use strict\";console.log(\"Connected to server at \"+location.hostname+\" on port \"+location.port+\".\");var r=i(233).client,o=i(232).client,n=i(231).client,a=i(230).client;i(2).client.trackName=\"Entity\";var s=i(49).client;s.trackName=\"Player\";var c=i(21).client,l=i(47).client,h=i(36).client,u=i(20).client;window.KEYS={};var p={screen:\"login\"};window.getClassLists=function(){return{Player:s.list,Item:c.list,Wall:l.list,Projectile:h.list,Decoration:u.list}},$(function(){$('#page-nav-assist a[href=\"#login-page\"]');var t=$('#page-nav-assist a[href=\"#load-page\"]'),e=$('#page-nav-assist a[href=\"#game-page\"]'),i=document.getElementById(\"gc\").getContext(\"2d\"),f=document.getElementById(\"mc\").getContext(\"2d\"),y=new a(i,f);y.resize({w:window.innerWidth,h:window.innerHeight}),$(window).resize(function(t){y.resize({w:window.innerWidth,h:window.innerHeight})}),window.Sprites=new o,Sprites.add(new r({ctx:i,src:\"/img/test.png\"})),Sprites.add(new r({ctx:i,src:\"/img/test2.png\"})),Sprites.add(new r({ctx:i,src:\"/img/gold.png\",name:\"item_gold\",w:64,h:64})),Sprites.add(new r({ctx:i,src:\"/img/bow.png\",name:\"item_bow\",w:64,h:64})),Sprites.add(new r({ctx:i,src:\"/img/arrow.png\",name:\"proj_arrow\",w:32,h:8})),Sprites.add(new r({ctx:i,src:\"/img/arrowItem.png\",name:\"item_arrow\",w:64,h:64})),Sprites.add(new r({ctx:i,src:\"/img/bandage.png\",name:\"item_bandage\",w:64,h:64})),Sprites.add(new r({ctx:i,src:\"/img/level_0.png\",name:\"level_0\",w:798,h:798})),Sprites.add(new r({ctx:i,src:\"/img/decoration_tree_0.png\",w:32,h:32})),Sprites.add(new r({ctx:i,src:\"/img/decoration_tree_1.png\",w:32,h:32})),Sprites.add(new r({ctx:i,src:\"/img/decoration_tree_2.png\",w:32,h:32})),Sprites.add(new r({ctx:i,src:\"/img/decoration_tree_3.png\",w:32,h:32})),Sprites.add(new r({ctx:i,src:\"/img/decoration_rock_0.png\",w:32,h:32})),Sprites.add(new r({ctx:i,src:\"/img/decoration_rock_1.png\",w:32,h:32})),Sprites.add(new r({ctx:i,src:\"/img/decoration_rock_2.png\",w:32,h:32})),Sprites.add(new r({ctx:i,src:\"/img/decoration_rock_3.png\",w:32,h:32})),Sprites.add(new r({ctx:i,src:\"/img/wood.png\",name:\"item_wood\",w:64,h:64})),Sprites.add(new r({ctx:i,src:\"/img/stone.png\",name:\"item_stone\",w:64,h:64}));var v=new n([Sprites]);function d(t){console.log(\"CHAT:  \"+t),$(\"#chat-view\").append('<div class=\"chat-msg\">'+t+\"</div>\");var e=$(\"#chat-hint\").append('<div class=\"chat-msg\">'+t+\"</div>\").find(\":last-child\").show().delay(5e3).fadeOut(1e3,function(t){console.log(t),e.remove()});$(\"#chat-view\").remove(\".chat-msg:nth-last-child(1n+50)\"),$(\"#chat-hint\").remove(\":nth-last-child(1n+10)\"),$(\"#chat-view\").scrollTop()>=$(\"#chat-view\").get(0).scrollHeight-$(\"#chat-view\").height()-40&&(console.log(\"Auto Scrolling\",$(\"#chat-view\").get(0).scrollHeight),$(\"#chat-view\").scrollTop($(\"#chat-view\").get(0).scrollHeight)),$(\"#chat-hint\").scrollTop($(\"#chat-hint\").get(0).scrollHeight)}socket.on(\"sign-in-res\",function(i){if($(\"#user\").get(0).setCustomValidity(\"\"),$(\"#pass\").get(0).setCustomValidity(\"\"),$(\"#user-feedback\").text(\"\"),i.success)g(\"load\"),t.tab(\"show\"),v.load($(\"#load-bar\"),function(){console.log(\"Finished loading assets.\",v.loaders),$(\"#game-page\").append($(v.loaders[0].list[1])),socket.emit(\"loaded\",$(\"#user\").val()),e.tab(\"show\"),g(\"game\")});else{switch(i.err){case\"dupe-acc\":$(\"#pass-feedback\").text(\"Error: Duplicate accounts found. Plaese contact the mods.\");break;case\"incorrect\":$(\"#pass-feedback\").text(\"Incorrect username or password.\");break;default:$(\"#pass-feedback\").text(\"Unknown Error. Please contact the mods.\")}$(\"#user\").get(0).setCustomValidity(\"Username Error\"),$(\"#pass\").get(0).setCustomValidity(\"Password Error\"),$(\"#login-form\").addClass(\"was-validated\")}}),socket.on(\"sign-up-res\",function(t){if($(\"#user-feedback\").text(\"\"),$(\"#pass-feedback\").text(\"\"),t.success)$(\"#user\").get(0).setCustomValidity(\"\"),$(\"#pass\").get(0).setCustomValidity(\"\"),$(\"#pass-message\").text(\"Sign-up Successful.\");else{switch(t.err){case\"dupe-acc\":$(\"#user-feedback\").text(\"Username taken. Please try another.\");break;default:$(\"#pass-feedback\").text(\"Unknown Error. Please contact the mods.\")}$(\"#user\").get(0).setCustomValidity(\"Username Taken\"),$(\"#pass\").get(0).setCustomValidity(\"Password Error\")}$(\"#login-form\").addClass(\"was-validated\")}),$(\"#login-form\").submit(function(t){t.preventDefault(),$(\"#user\").get(0).setCustomValidity(\"\"),$(\"#pass\").get(0).setCustomValidity(\"\");var e=$(\"#user\").val(),i=$(\"#pass\").val();return\"\"==e?($(\"#user\").get(0).setCustomValidity(\"No Username\"),$(\"#user-feedback\").text(\"Please enter a username.\"),$(\"#login-form\").addClass(\"was-validated\"),t.stopPropagation(),!1):\"\"==i?($(\"#pass\").get(0).setCustomValidity(\"No Password\"),$(\"#pass-feedback\").text(\"Please enter a password.\"),$(\"#login-form\").addClass(\"was-validated\"),t.stopPropagation(),!1):void socket.emit(\"sign-in\",{user:e,pass:i})}),$(\"#sign-up\").click(function(t){$(\"#user\").get(0).setCustomValidity(\"\"),$(\"#pass\").get(0).setCustomValidity(\"\"),t.preventDefault();var e=$(\"#user\").val(),i=$(\"#pass\").val();return\"\"==e?($(\"user-feedback\").text(\"Please enter a username.\"),t.stopPropagation(),!1):\"\"==i?($(\"pass-feedback\").text(\"Please enter a password.\"),t.stopPropagation(),!1):void socket.emit(\"sign-up\",{user:e,pass:i})}),socket.on(\"init\",function(t){for(var e in window.PlayerId=t.playerId,t.initPkt.Player)new s(t.initPkt.Player[e]);for(var i in t.initPkt.Item)new c(t.initPkt.Item[i]);for(var r in t.initPkt.Wall)new l(t.initPkt.Wall[r]);for(var o in t.initPkt.Projectile)new h(t.initPkt.Projectile[o]);for(var n in t.initPkt.Decoration)new u(t.initPkt.Decoration[n]);socket.on(\"update\",function(t){!function(t){for(var e in t.Player){var i=s.list[e];i.update(t.Player[e])}for(var r in t.Item){var o=c.list[r];o.update(t.Item[r])}for(var n in t.Wall){var a=l.list[n];a.update(t.Wall[n])}for(var u in t.Projectile){var p=h.list[u];p.update(t.Projectile[u])}}(t)}),socket.on(\"init-pkt\",function(t){!function(t){for(var e in t.Player)new s(t.Player[e]);for(var i in t.Item)new c(t.Item[i]);for(var r in t.Wall)new l(t.Wall[r]);for(var o in t.Projectile){new h(t.Projectile[o]);console.log(\"New Projectile\")}for(var n in t.Decoration){new u(t.Decoration[n]);console.log(\"New Deco\")}}(t)}),socket.on(\"remove\",function(t){!function(t){var e=!0,i=!1,r=void 0;try{for(var o,n=t.Player[Symbol.iterator]();!(e=(o=n.next()).done);e=!0){var a=o.value;d(s.list[a].name+\" left the game.\"),s.list[a].remove()}}catch(t){i=!0,r=t}finally{try{!e&&n.return&&n.return()}finally{if(i)throw r}}var p=!0,f=!1,y=void 0;try{for(var v,m=t.Item[Symbol.iterator]();!(p=(v=m.next()).done);p=!0){var g=v.value;c.list[g].remove()}}catch(t){f=!0,y=t}finally{try{!p&&m.return&&m.return()}finally{if(f)throw y}}var b=!0,k=!1,w=void 0;try{for(var x,_=t.Wall[Symbol.iterator]();!(b=(x=_.next()).done);b=!0){var P=x.value;l.list[P].remove()}}catch(t){k=!0,w=t}finally{try{!b&&_.return&&_.return()}finally{if(k)throw w}}var O=!0,j=!1,S=void 0;try{for(var $,I=t.Projectile[Symbol.iterator]();!(O=($=I.next()).done);O=!0){var N=$.value;h.list[N].remove()}}catch(t){j=!0,S=t}finally{try{!O&&I.return&&I.return()}finally{if(j)throw S}}var C=!0,E=!1,T=void 0;try{for(var M,z=t.Decoration[Symbol.iterator]();!(C=(M=z.next()).done);C=!0){var U=M.value;u.list[U].remove()}}catch(t){E=!0,T=t}finally{try{!C&&z.return&&z.return()}finally{if(E)throw T}}}(t)}),socket.on(\"chat\",function(t){d(t)}),socket.on(\"eval-res\",function(t){d(t)}),socket.on(\"kill\",function(t){$(\"#killer\").text(t),g(\"dead\")}),socket.on(\"respawn\",function(){g(\"game\")}),requestAnimationFrame(m)});var m=function t(){y.clear();var e=s.list[PlayerId];for(var i in y.camera.setPos(e.x+e.w/2,e.y+e.h/2),y.update(),y.background(Sprites.get(\"level_\"+e.world)),y.colour(\"black\"),y.lineWidth(2),y.ctx.beginPath(),y.ctx.moveTo(-10,0),y.ctx.lineTo(10,0),y.ctx.moveTo(0,-10),y.ctx.lineTo(0,10),y.ctx.stroke(),c.list)c.list[i].render(y);for(var r in l.list)l.list[r].render(y);for(var o in h.list)h.list[o].render(y);for(var n in s.list)s.list[n].render(y);y.reset(),function(){var t=s.list[PlayerId];for(var e in y.colour(\"red\"),y.rect({x:20,y:y.height-40,w:200,h:20}),y.colour(\"green\"),y.rect({x:20,y:y.height-40,w:t.health/t.maxHealth*200,h:20}),y.colour(\"white\"),y.font(\"15px Arial\"),y.text(t.health+\"/\"+t.maxHealth,120,y.height-30),y.colour(\"grey\"),y.rect({x:y.width-220,y:y.height-40,w:200,h:20}),y.colour(\"blue\"),y.rect({x:y.width-220,y:y.height-40,w:t.mana/t.maxMana*200,h:20}),y.colour(\"white\"),y.font(\"15px Arial\"),y.text(t.mana+\"/\"+t.maxMana,y.width-120,y.height-30),y.colour(\"grey\"),y.rect({x:240,y:y.height-40,w:y.width-480,h:20}),y.colour(\"lime\"),y.rect({x:240,y:y.height-40,w:t.exp/t.toNextL*(y.width-480),h:20}),y.font(\"30px Consolas\"),y.textWO(\"\"+t.level,y.width/2,y.height-45,\"white\",\"black\"),y.colour(\"#333333\"),y.rect({x:y.width/2-450,y:20,w:900,h:100}),t.inventory.hotbar)y.colour(\"grey\"),y.lineWidth(1),y.rect({x:y.width/2-450+100*e,y:20,w:100,h:100},!0),null!=t.inventory.hotbar[e].item&&Sprites.get(\"item_\"+t.inventory.hotbar[e].item).drawCenter(y,{x:y.width/2-400+100*e,y:70,w:64,h:64}),y.colour(\"white\"),y.font(\"20px Arial\"),null!=t.inventory.hotbar[e].item&&t.inventory.hotbar[e].count>1&&y.text(t.inventory.hotbar[e].count,y.width/2-365+100*e,110);y.colour(\"#cccccc\"),y.lineWidth(3),y.rect({x:y.width/2-450+100*t.inventory.selectedSlot,y:20,w:100,h:100},!0)}(),requestAnimationFrame(t)};function g(t){switch(t){case\"login\":case\"load\":$(\"#chat-pane\").hide();break;case\"game\":$(\"#chat-pane\").hide(),$(\"#chat-input\").blur(),$(\"#chat-input\").val(\"\"),$(\"#death-screen\").hide();break;case\"chat\":$(\"#chat-pane\").show(),$(\"#chat-view .chat-msg\").show(),console.log(\"Auto Scrolling\",$(\"#chat-view\").get(0).scrollHeight),$(\"#chat-view\").scrollTop($(\"#chat-view\").get(0).scrollHeight),$(\"#chat-input\").focus();break;case\"dead\":$(\"#chat-pane\").hide(),$(\"#chat-input\").blur(),$(\"#chat-input\").val(\"\"),$(\"#death-screen\").show()}p.screen=t}y.canvas.mousedown(function(t){t.preventDefault(),socket.emit(\"mousedown\",{x:t.offsetX+y.camera.x-y.width/2,y:t.offsetY+y.camera.y-y.height/2,button:t.button})}),y.canvas.mouseup(function(t){t.preventDefault(),socket.emit(\"mouseup\",{x:t.offsetX+y.camera.x-y.width/2,y:t.offsetY+y.camera.y-y.height/2,button:t.button})}),y.canvas.bind(\"contextmenu\",function(t){t.preventDefault()}),$(document).keydown(function(t){KEYS[t.key.toUpperCase()]=!0,console.log(t.key.toUpperCase()),KEYS[String.fromCharCode(92)]&&\"game\"==p.screen&&(g(\"chat\"),t.preventDefault()),KEYS.ESCAPE&&\"game\"!=p.screen&&g(\"game\"),socket.emit(\"key\",KEYS)}),$(document).keyup(function(t){KEYS[t.key.toUpperCase()]=!1,socket.emit(\"key\",KEYS)}),$(\"#chat-form\").submit(function(t){t.preventDefault();var e=$(\"#chat-input\").val();\"/\"==e.charAt(0)?socket.emit(\"eval\",e.slice(1)):socket.emit(\"chat\",e),$(\"#chat-history\").append(\"<option value='\"+e.replace(/\"/g,\"&quot;\").replace(/'/g,\"&apos;\")+\"'>\"),g(\"game\")})})},36:function(t,e,i){\"use strict\";var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),o=function t(e,i,r){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,i);if(void 0===o){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,i,r)}if(\"value\"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0};function n(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}function a(t,e){if(!t)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!e||\"object\"!=typeof e&&\"function\"!=typeof e?t:e}function s(t,e){if(\"function\"!=typeof e&&null!==e)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var c=i(2),l=function(t){function e(t){n(this,e);var i=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),r=t.variant,o=t.rot;return i.variant=r,i.rot=o,e.list[i.id]=i,console.log(\"New Projectile\",e.list),i}return s(e,c.client),r(e,[{key:\"render\",value:function(t){Sprites.get(\"proj_\"+this.variant).drawCenter(t,this)}},{key:\"update\",value:function(t){this.rot=t.rot,o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"update\",this).call(this,t)}},{key:\"remove\",value:function(){delete e.list[this.id],o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"remove\",this).call(this)}},{key:\"type\",get:function(){var t=o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"type\",this);return t.push(e.trackName),t}}]),e}(),h=function(t){function e(t){n(this,e);var i=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),r=t.variant,o=t.damage,s=t.pId,c=t.hsp,l=t.vsp;return i.variant=r,i.damage=o,i.pId=s,i.age=0,i.hsp=c,i.vsp=l,e.list[i.id]=i,initPack[e.trackName][i.id]=i.getInitPkt(),i}return s(e,c.server),r(e,[{key:\"getInitPkt\",value:function(){var t=o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"getInitPkt\",this).call(this);return t.variant=this.variant,t.rot=this.rot,t}},{key:\"getUpdatePkt\",value:function(){var t=o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"getUpdatePkt\",this).call(this);return t.rot=this.rot,t}},{key:\"remove\",value:function(){delete e.list[this.id],o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"remove\",this).call(this)}},{key:\"update\",value:function(){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"update\",this).call(this);var t=this.collision(this.x,this.y,!1,\"Player\");t&&this.onHit(t),this.age++,this.age>=1e3&&this.remove()}},{key:\"onHit\",value:function(t){t.id!=this.pId&&(t.damage(this.damage,t.constructor.list[this.pId]),this.remove())}},{key:\"rot\",get:function(){return Math.atan2(this.vsp,this.hsp)}},{key:\"type\",get:function(){var t=o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"type\",this);return t.push(e.trackName),t}}],[{key:\"getUpdate\",value:function(){var t={};for(var i in e.list){var r=e.list[i];r.dirty&&(t[i]=r.getUpdatePkt())}return t}},{key:\"getInit\",value:function(){var t={};for(var i in e.list){var r=e.list[i];t[i]=r.getInitPkt()}return t}},{key:\"update\",value:function(){for(var t in e.list){e.list[t].update()}}}]),e}();l.list={},h.list={},l.trackName=h.trackName=\"Projectile\",t.exports={client:l,server:h}},47:function(t,e,i){\"use strict\";var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),o=function t(e,i,r){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,i);if(void 0===o){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,i,r)}if(\"value\"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0};function n(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}function a(t,e){if(!t)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!e||\"object\"!=typeof e&&\"function\"!=typeof e?t:e}function s(t,e){if(\"function\"!=typeof e&&null!==e)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var c=i(2),l=function(t){function e(t){n(this,e);var i=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return e.list[i.id]=i,i}return s(e,c.client),r(e,[{key:\"remove\",value:function(){delete this.constructor.list[this.id],o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"remove\",this).call(this)}},{key:\"render\",value:function(t){t.colour(\"grey\"),t.centerRect(this),t.colour(\"black\"),t.lineWidth(2),t.centerRect(this,!0),t.minimap.colour(\"grey\"),t.minimap.centerRect(this)}},{key:\"type\",get:function(){var t=o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"type\",this);return t.push(e.trackName),t}}]),e}(),h=function(t){function e(t){n(this,e),t.solid=!0;var i=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return e.list[i.id]=i,initPack[e.trackName][i.id]=i.getInitPkt(),i}return s(e,c.server),r(e,[{key:\"getInitPkt\",value:function(){return o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"getInitPkt\",this).call(this)}},{key:\"getUpdatePkt\",value:function(){var t=o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"getUpdatePkt\",this).call(this);return t.w=this.w,t.h=this.h,t}},{key:\"type\",get:function(){var t=o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"type\",this);return t.push(e.trackName),t}}],[{key:\"getUpdate\",value:function(){var t={};for(var i in e.list){var r=e.list[i];r.dirty&&(t[i]=r.getUpdatePkt())}return t}},{key:\"getInit\",value:function(){var t={};for(var i in e.list){var r=e.list[i];t[i]=r.getInitPkt()}return t}}]),e}();l.trackName=h.trackName=\"Wall\",h.list={},l.list={},t.exports={client:l,server:h}},48:function(t,e,i){\"use strict\";var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}();function o(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}var n=i(21),a=function(){function t(e){var i=e.size,r=void 0===i?1:i,n=e.hotbarSize,a=void 0===n?0:n;o(this,t),this.size=r-a,this.hotbarSize=a,this.totalSize=r,this.list=[],this.hotbar=[],this.selectedSlot=0,this.clear()}return r(t,[{key:\"update\",value:function(t,e,i){this.hotbar=t,this.list=e,this.selectedSlot=i}},{key:\"clear\",value:function(){for(var t=0;t<this.size;t++)this.list[t]={count:0,item:null};for(var e=0;e<this.hotbarSize;e++)this.hotbar[e]={count:0,item:null}}},{key:\"selected\",get:function(){return this.hotbar[this.selectedSlot]}}]),t}(),s=function(){function t(e){var i=e.size,r=void 0===i?1:i,n=e.hotbarSize,a=void 0===n?0:n;o(this,t),this.size=r-a,this.hotbarSize=a,this.totalSize=r,this.list=[],this.hotbar=[],this.selectedSlot=0,this.clear()}return r(t,[{key:\"drop\",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=this[t][e].item;if(null==a)return 0;var s=Math.min(this[t][e].count,i);return 0==s?0:(this[t][e].count-=s,this[t][e].count<=0&&(this[t][e].item=null),new n.server({item:a,count:s,x:r,y:o,delay:100}),s)}},{key:\"remove\",value:function(t,e,i){if(\"any\"==t){var r=this.getFirst(e);if(e=r.slot,t=r.from,e<=-1)return}if(null==this[{hotbar:\"hotbar\",inventory:\"list\"}[t]][e].item)return 0;var o=Math.min(this[t][e].count,i);return 0==o?0:(this[t][e].count-=o,this[t][e].count<=0&&(this[t][e].item=null),o)}},{key:\"getFirst\",value:function(t){switch(arguments.length>1&&void 0!==arguments[1]?arguments[1]:\"any\"){case\"inventory\":return this.list.findIndex(function(e){return e.item==t});case\"hotbar\":return this.hotbar.findIndex(function(e){return e.item==t});case\"any\":var e=this.hotbar.findIndex(function(e){return e.item==t});return e>-1?{slot:e,from:\"hotbar\"}:{slot:this.list.findIndex(function(e){return e.item==t}),from:\"inventory\"}}}},{key:\"add\",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:\"any\",r=arguments[3],o=e;if(0==e)return console.log(\"Error in amount\"),0;if(null==t)return console.log(\"Error in type\"),0;if(![\"any\",\"hotbar\",\"inventory\"].includes(i))return console.log(\"Error in to\"),0;switch(i){case\"any\":for(var n=0;n<this.hotbarSize;n++)if(!(this.hotbar[n].count>99||null!=this.hotbar[n].item&&this.hotbar[n].item!=t)){var a=this.hotbar[n],s=Math.min(e,99-a.count);if(null==a.item&&(a.item=t),a.count+=s,(e-=s)<=0)break}if(e<=0)return o;for(var c=0;c<this.size;c++)if(!(this.list[c].count>99||null!=this.list[c].item&&this.list[c].item!=t)){var l=this.list[c],h=Math.min(e,99-l.count);if(null==l.item&&(l.item=t),l.count+=h,(e-=h)<=0)break}return e<=0?o:o-e;case\"hotbar\":if(void 0!==r){if(this.hotbar[r].count>99||null!=this.hotbar[r].item&&this.hotbar[r].item!=t)return 0;var u=this.hotbar[r],p=Math.min(e,99-u.count);return null==u.item&&(u.item=t),u.count+=p,o-(e-=p)}for(var f=0;f<this.hotbarSize;f++)if(!(this.hotbar[f].count>99||null!=this.hotbar[f].item&&this.hotbar[f].item!=t)){var y=this.hotbar[f],v=Math.min(e,99-y.count);if(null==y.item&&(y.item=t),y.count+=v,(e-=v)<=0)break}return e<=0?o:o-e;case\"inventory\":if(void 0!==r){if(this.hotbar[r].count>99||null!=this.hotbar[r].item&&this.hotbar[r].item!=t)return 0;var d=this.hotbar[r],m=Math.min(e,99-d.count);return null==d.item&&(d.item=t),d.count+=m,o-(e-=m)}for(var g=0;g<this.size;g++)if(!(this.list[g].count>99||null!=this.list[g].item&&this.list[g].item!=t)){var b=this.list[g],k=Math.min(e,99-b.count);if(null==b.item&&(b.item=t),b.count+=k,(e-=k)<=0)break}return e<=0?o:o-e}}},{key:\"set\",value:function(t,e,i,r){return!(![\"hotbar\",\"inventory\"].includes(t)||e>this[\"inventory\"==t?\"list\":t].length-1)&&(this[\"inventory\"==t?\"list\":t][e]={type:r||this[\"inventory\"==t?\"list\":t][e].item,count:Math.min(99,Math.max(0,i))},!0)}},{key:\"clear\",value:function(){for(var t=0;t<this.size;t++)this.list[t]={count:0,item:null};for(var e=0;e<this.hotbarSize;e++)this.hotbar[e]={count:0,item:null}}},{key:\"selected\",get:function(){return this.hotbar[this.selectedSlot]}}]),t}();t.exports={client:a,server:s}},49:function(t,e,i){\"use strict\";var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),o=function t(e,i,r){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,i);if(void 0===o){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,i,r)}if(\"value\"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0};function n(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}function a(t,e){if(!t)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!e||\"object\"!=typeof e&&\"function\"!=typeof e?t:e}function s(t,e){if(\"function\"!=typeof e&&null!==e)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var c=i(2),l=i(48),h=function(t){function e(t){n(this,e);var i=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),r=t.name,o=t.inventory,s=t.maxMana,c=t.mana,h=t.maxHealth,u=t.health,p=(t.selectedSlot,t.exp),f=t.toNextL,y=t.level;return i.name=r,i.maxHealth=h,i.health=u,i.maxMana=s,i.mana=c,i.exp=p,i.toNextL=f,i.level=y,i.inventory=new l.client(o),e.list[i.id]=i,i}return s(e,c.client),r(e,[{key:\"render\",value:function(t){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"render\",this).call(this,t),t.minimap.colour(\"lime\"),t.minimap.centerRect(this),t.font(\"10px Arial\"),t.colour(\"black\"),t.text(this.name,this.x,this.y-this.h/.8),t.text(\"Level: \"+this.level,this.x,this.y-this.h/.6),t.colour(\"red\"),t.rect({x:this.x-this.w/2,y:this.y-this.w,w:32,h:5}),t.colour(\"green\"),t.rect({x:this.x-this.w/2,y:this.y-this.w,w:this.health/this.maxHealth*32,h:5})}},{key:\"update\",value:function(t){this.inventory.update(t.inventory.hotbar,t.inventory.list,t.inventory.selectedSlot),this.health=t.health,this.maxHealth=t.maxHealth,this.mana=t.mana,this.maxMana=t.maxMana,this.exp=t.exp,this.toNextL=t.toNextL,this.level=t.level,delete t.inventory,o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"update\",this).call(this,t)}},{key:\"remove\",value:function(){delete this.constructor.list[this.id],o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"remove\",this).call(this)}},{key:\"type\",get:function(){var t=o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"type\",this);return t.push(e.trackName),t}}]),e}(),u=function(t){function e(t){n(this,e);var i=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),r=t.name,o=void 0===r?\"player\":r,s=t.socket,c=t.moveSpeed,h=void 0===c?5:c,u=t.maxHealth,p=void 0===u?20:u,f=t.health,y=void 0===f?p:f,v=t.maxMana,d=void 0===v?100:v,m=t.mana,g=void 0===m?d:m;return i.name=o,i.socket=s,i.moveSpeed=h,i.keys={},i.dead=!1,i.deathTime=0,i.mouse={button:0,x:i.x,y:i.y},i.mouseThisTick=0,i.maxHealth=p,i.health=y,i.maxMana=d,i.mana=g,i.exp=0,i.toNextL=100,i.level=0,i.inventory=new l.server({size:36,hotbarSize:9}),e.list[i.id]=i,initPack[e.trackName][i.id]=i.getInitPkt(),i}return s(e,c.server),r(e,[{key:\"getInitPkt\",value:function(){var t=o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"getInitPkt\",this).call(this);return t.name=this.name,t.maxHealth=this.maxHealth,t.health=this.health,t.maxMana=this.maxMana,t.mana=this.mana,t.exp=this.exp,t.toNextL=this.toNextL,t.level=this.level,t.inventory={size:this.inventory.totalSize,hotbarSize:this.inventory.hotbarSize},t}},{key:\"update\",value:function(){if(this.dead)this.deathTime--,this.deathTime<=0&&this.respawn();else{if(this.toNextL<=this.exp&&(this.level++,this.exp-=this.toNextL,this.toNextL+=10*this.level),this.hsp=(Number(Boolean(this.keys.D)||Boolean(this.keys.ARROWRIGHT))-Number(Boolean(this.keys.A)||Boolean(this.keys.ARROWLEFT)))*this.moveSpeed,this.vsp=(Number(Boolean(this.keys.S)||Boolean(this.keys.ARROWDOWN))-Number(Boolean(this.keys.W)||Boolean(this.keys.ARROWUP)))*this.moveSpeed,1==this.mouseThisTick){var t=global.Tool.get(this.inventory.selected.item);if(t)t.use(this);else{var i=this.collision(this.x,this.y,!1,\"Tree\")||this.collision(this.x,this.y,!1,\"Rock\");i&&i.damage(1,this)}}if(3==this.mouseThisTick){var r=global.Consumable.get(this.inventory.selected.item);r&&r.use(this,this.inventory.selectedSlot)}if(this.keys[1]||this.keys[2]||this.keys[3]||this.keys[4]||this.keys[5]||this.keys[6]||this.keys[7]||this.keys[8]||this.keys[9]){for(var n=[],a=1;a<10;a++)this.keys[a]&&n.push(a);this.inventory.selectedSlot=n[0]?n[0]-1:this.inventory.selectedSlot}this.mouseThisTick=0,o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"update\",this).call(this)}}},{key:\"respawn\",value:function(){this.x=0,this.y=0,this.dead=!1,this.deathTime=0,this.exp=0,this.health=this.maxHealth,this.mana=this.maxMana,this.socket.emit(\"respawn\")}},{key:\"damage\",value:function(t,e){this.dead||(this.health=Math.max(this.health-t,0),this.health<=0?this.kill(e):this.socket.emit(\"damage\",t))}},{key:\"heal\",value:function(t){this.dead||(this.health=Math.min(this.maxHealth,this.health+t))}},{key:\"kill\",value:function(t){for(var e in this.dead=!0,this.deathTime=300,this.hsp=this.vsp=0,this.keys)this.keys[e]=!1;for(var i=0;i<this.inventory.hotbarSize;i++)this.inventory.drop(\"hotbar\",i,1/0,this.x,this.y);for(var r=0;r<this.inventory.size;r++)this.inventory.drop(\"list\",r,1/0,this.x,this.y);t.exp+=Math.floor(10*Math.random()),this.socket.emit(\"kill\",t.name)}},{key:\"getUpdatePkt\",value:function(){var t=o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"getUpdatePkt\",this).call(this);return t.name=this.name,t.maxHealth=this.maxHealth,t.health=this.health,t.maxMana=this.maxMana,t.mana=this.mana,t.exp=this.exp,t.toNextL=this.toNextL,t.level=this.level,t.inventory={list:this.inventory.list,hotbar:this.inventory.hotbar,selectedSlot:this.inventory.selectedSlot},t}},{key:\"type\",get:function(){var t=o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"type\",this);return t.push(e.trackName),t}}],[{key:\"getUpdate\",value:function(){var t={};for(var i in e.list){var r=e.list[i];r.dirty&&(t[i]=r.getUpdatePkt())}return t}},{key:\"getInit\",value:function(){var t={};for(var i in e.list){var r=e.list[i];t[i]=r.getInitPkt()}return t}},{key:\"broadcast\",value:function(t,i){for(var r in e.list)e.list[r].socket.emit(t,i)}}]),e}();u.list={},h.list={},t.exports={client:h,server:u}},50:function(t,e,i){\"use strict\";var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}();function o(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}var n=void 0;var a=function(){function t(e){o(this,t),this.id=e.id,t.list[this.id]=this,this.update=this.update.bind(this)}return r(t,[{key:\"update\",value:function(t){}},{key:\"remove\",value:function(){delete this.constructor.list[this.id]}},{key:\"type\",get:function(){var e=new Array;return e.push(t.trackName),e}}]),t}();a.trackName=\"\",a.trackList={},a.list={};var s=function(){function t(e){o(this,t),this.id=void 0!==e.id?e.id:n(),this.dirty=!1,t.list[this.id]=this,this.markDirty=this.markDirty.bind(this),this.remove=this.remove.bind(this),this.getUpdatePkt=this.getUpdatePkt.bind(this),this.getInitPkt=this.getInitPkt.bind(this)}return r(t,[{key:\"markDirty\",value:function(){this.dirty||(this.dirty=!0)}},{key:\"remove\",value:function(){global.removePack[this.constructor.trackName].includes(this.id)||global.removePack[this.constructor.trackName].push(this.id),delete this.constructor.list[this.id]}},{key:\"getUpdatePkt\",value:function(){return{id:this.id}}},{key:\"getInitPkt\",value:function(){return{id:this.id}}},{key:\"type\",get:function(){var e=new Array;return e.push(t.trackName),e}}],[{key:\"update\",value:function(){for(var e in t.list){t.list[e].update()}}},{key:\"getUpdate\",value:function(){var e={};for(var i in t.list){var r=t.list[i];r.dirty&&(e[i]=r.getUpdatePkt())}return e}},{key:\"getInit\",value:function(){var e={};for(var i in t.list){var r=t.list[i];r.dirty&&(e[i]=r.getInitPkt())}return e}},{key:\"getRemove\",value:function(){var e={};for(var i in t.list){var r=t.list[i];r.dirty&&(e[i]=r.getRemovePkt())}return e}}]),t}();s.trackName=\"\",s.trackList={},s.list={},t.exports={client:a,server:s}}});","extractedComments":[]}